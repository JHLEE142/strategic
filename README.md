# 거래처 탐색 도우미

Streamlit 기반의 하이브리드 규칙/AI 웹 애플리케이션으로, 엑셀 파일에 저장된 거래처 정보를 업로드하고 프롬프트를 입력하면 해당 조건에 맞는 거래처를 빠르게 찾을 수 있습니다. 규칙 기반 점수/태깅에 더해 Hugging Face Router를 통한 `Qwen/Qwen3-4B-Instruct-2507:nscale` 모델로 전략적인 영업 제안을 생성합니다.

## 주요 기능
- 엑셀 파일 업로드 (`.xlsx`, `.xls`)
- 프롬프트 키워드 50% 이상 매칭 시 최대 300개의 결과만 노출
- 키워드 가중치, 상담 횟수, 최근 상담일, 감성 패턴을 활용한 리드 점수 산출
- Hot / Warm / Cold 등급 분류 및 후속 액션 추천
- 태그・감성 분포・추천 액션 등을 포함한 대시보드 제공
- 검색 결과를 테이블 형태로 확인 및 엑셀로 다운로드

## 실행 방법
1. 필요한 패키지 설치:
   ```bash
   pip install -r requirements.txt
   ```
2. `.env` 파일 생성 또는 환경 변수 설정:
   ```bash
   echo "HUGGINGFACE_API_KEY=hf_********************************" > .env
   ```
   (또는 기존 환경 변수 방식으로 `export`/`setx` 명령을 사용해도 됩니다.)

3. Streamlit 앱 실행:
   ```bash
   streamlit run main.py
   ```
4. 브라우저에서 안내에 따라 파일을 업로드하고, 프롬프트를 입력한 뒤 결과 페이지에서 검색 결과와 AI 전략 제안을 확인하세요.

## 규칙 기반 엔진 개요
- **키워드 가중치**: `main.py`의 `KEYWORD_RULES`에서 태그/키워드/가중치를 조정할 수 있습니다.
- **감성 패턴**: 긍정/중립/부정 키워드에 따라 추가 점수가 반영됩니다.
- **상담 관련 지표**: `상담횟수`(또는 유사 열명)와 `최근상담일` 정보를 자동 인식해 점수에 반영합니다.
- **리드 등급**: 점수 70 이상은 Hot, 40~69는 Warm, 그 이하는 Cold로 분류합니다.
- **추천 액션**: 등급과 최근 상담일을 바탕으로 후속 활동을 제안합니다.

## AI 전략 제안
- `HUGGINGFACE_API_KEY`가 설정되어 있으면 Hugging Face Router(OpenAI 호환 API)를 통해 Qwen 모델을 호출합니다.
- AI에게 전달되는 프롬프트는 거래처 데이터 미리보기(최대 20건)와 사용자 입력을 포함하며, 실행 가능한 영업 전략을 생성하도록 지시합니다.
- 네트워크 오류 또는 키 미설정 시 친절한 안내 메시지가 표시됩니다.

## 검색 팁
- 여러 조건을 입력할 때는 공백으로 구분해 주세요. 전체 키워드 중 절반 이상이 일치하면 결과로 표시됩니다.
- 업로드한 엑셀 파일의 모든 열에서 검색이 이뤄집니다. 필요하다면 엑셀 데이터를 미리 정리해 주시면 더 정확한 검색이 가능합니다.
- `상담횟수`, `최근상담일` 등에 해당하는 열 이름을 사용하면 리드 점수가 더욱 정교해집니다.

